<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>Ruslan Osipov</title>
  <meta name="author" content="Ruslan Osipov">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.rosipov.com/posts/12/">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="Ruslan Osipov" type="application/atom+xml">

  <!-- http://opengraphprotocol.org/ -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://www.rosipov.com/posts/12/">
  <meta property="og:title" content="Ruslan Osipov">
  

  <link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">


  
  <link href="/stylesheets/screen.css" media="screen, projection, print" rel="stylesheet" type="text/css">

  
   <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-48506044-1', 'auto');
    ga('send', 'pageview');

  </script>


  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-9673275857851395",
    enable_page_level_ads: true
  });
</script>

</head>

  <body   >
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" title="toggle navbar" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Ruslan Osipov</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a rel="index" href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/about">About</a>
                </li>
                <li >
                    <a href="/blog/archive">Archive</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="navbar-form navbar-right" action="https://www.google.com/search" method="GET">
                    <input type="hidden" name="sitesearch" value="www.rosipov.com">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" role="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9">
    <div class="blog-index" itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="name" content="Ruslan Osipov" />
    
    <meta itemprop="url" content="http://www.rosipov.com" />
      
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-11-24T04:14:19+00:00"  data-updated="true" itemprop="datePublished dateCreated">Sun 24 Nov 2013,  4:14 AM</time>
        
           | <a href="/blog/old-file-version-in-split-with-vim/#disqus_thread" itemprop="discussionUrl"
             data-disqus-identifier="http://www.rosipov.com/blog/old-file-version-in-split-with-vim/">Comments</a>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/old-file-version-in-split-with-vim/" itemprop="url">Old file version in split with vim</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>If you use git VCS, you can view previous version of the file you are currently
editing in a split window by executing following command:</p>

<pre><code>:vsp tmp | read !git show HEAD^:path/from/working/directory
</code></pre>

<p>For the instant syntax highlighting, you can specify temporary file&rsquo;s
extension, like following:</p>

<pre><code>:vsp tmp.py | read !git show HEAD^:lib/module.py
</code></pre>

<p>You can also cycle back by few versions by replacing <code>HEAD^</code> (which points to
the previous commit) with <code>HEAD~N</code>, where <code>N</code> is the number of commits you
would like to go back in history by. For example, if you would like to get a
version of the file 4 commits ago - you can do so by executing following
command:</p>

<pre><code>:vsp tmp | read !git show HEAD~4:path/from/working/directory
</code></pre>

<p>It&rsquo;s a pretty nice hack when you need to quickly view previous version of the
file you are working on.</p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-11-17T01:02:30+00:00"  data-updated="true" itemprop="datePublished dateCreated">Sun 17 Nov 2013,  1:02 AM</time>
        
           | <a href="/blog/pasting-with-vim-and-indentation-issues/#disqus_thread" itemprop="discussionUrl"
             data-disqus-identifier="http://www.rosipov.com/blog/pasting-with-vim-and-indentation-issues/">Comments</a>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/pasting-with-vim-and-indentation-issues/" itemprop="url">Pasting with vim and indentation issues</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>If you use vim often - you probably had to paste something into vim from the
outside source. And, if you have corresponding indentation rules, they will get
applied, turning your nice block of code into something that looks more like a
case of stairs:</p>

<pre><code>def foo(a, b):
        a, b = b, a
            print "I am doing something important."
                return a - b
</code></pre>

<p>Quite nasty, isn&rsquo;t it? But that&rsquo;s where vim&rsquo;s <code>paste</code> option comes in.  Before
pasting, execute <code>:set paste</code>. If you go into insert mode, you&rsquo;ll see the usual
mode indicator switch to <code>-- INSERT (paste) --</code>. Try pasting the same block of
code now:</p>

<pre><code>def foo(a, b):
    a, b = b, a
    print "I am doing something important."
    return a - b
</code></pre>

<p>Beautiful. Don&rsquo;t forget to switch back to a regular mode by executing <code>:set
nopaste</code>.</p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-09-12T01:26:15+00:00"  data-updated="true" itemprop="datePublished dateCreated">Thu 12 Sep 2013,  1:26 AM</time>
        
           | <a href="/blog/remap-your-caps-lock/#disqus_thread" itemprop="discussionUrl"
             data-disqus-identifier="http://www.rosipov.com/blog/remap-your-caps-lock/">Comments</a>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/remap-your-caps-lock/" itemprop="url">Remap your Caps Lock</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>The following three paragraphs are an angry <code>Caps Lock</code> rant. Feel free to skip
past it or join me by commenting below.</p>

<p>I&rsquo;ve had it with <code>Caps Lock</code>! How many times did I accidentally press it while
hitting the <code>A</code> key! How many times did I mean <code>Tab</code> or <code>Shift</code>! There is an
obvious problem with the <code>Caps Lock</code> placement, and there being only a
millimeter of space to designate it from an adjacent key, it is quite difficult
to notice when you accidentally press it.</p>

<p>Pushing <code>Caps Lock</code> is more tolerable when typing, but while using keyboard
controlled software it&rsquo;s a real pain; <code>vim</code> turns into a beeping ravaging
nightmare, <code>vimperator</code> messes up all your bookmarks&hellip; Same thing with
websites supporting keyboard shortcuts.</p>

<p>When was the last time I ever used <code>Caps Lock</code>? Over ten years ago, when I was
playing a video game that used <code>Caps Lock</code> to switch between running and
walking. Em&hellip; Seriously? Time to put an end this nonsense.</p>

<h2>Linux and Mac</h2>

<p>Drop this into your <code>~/bin/capslockremap</code>, and don&rsquo;t forget to <code>chmod +x
~/bin/capslockremap</code>. Now run the script with root privileges (that&rsquo;ll last you
until the next restart).</p>

<pre><code>#!/bin/sh

# This temporarily remaps the Caps Lock key to a Control key.
# The keyboard will return to the previous settings after a
# reboot. The Linux console and the X Window system each
# handles keypresses separately, so each must be remapped
# separately. First remap the X keyboard since this does not
# require root access.

# Remap the Caps Lock key to a Control key for
# the X Window system.
if type setxkbmap &gt;/dev/null 2&gt;&amp;1; then
fi

# You have to be root to remap the console keyboard.
if [ "$(id -u)" != "0" ]; then
  echo "This script is not running as root so"
  echo "the console Caps Lock cannot be remapped."
  echo "Perhaps you forgot to run this under sudo."
  echo "Note that this problem does not effect X."
  echo "This only effects the consoles running on"
  echo "Alt-f1 through Alt-f6."
  exit 2
fi
# Remap the CapsLock key to a Control key for the console.
(dumpkeys | grep keymaps; echo "keycode 58 = Control") | loadkeys
</code></pre>

<h2>Windows</h2>

<p>Download <a href="http://technet.microsoft.com/en-us/sysinternals/bb897578.aspx">Sysinternals Ctrl2Cap v2.0</a>, run it as Administrator with
<code>install</code> flag: <code>ctrl2cap.exe /install</code>.</p>

<p>Source <a href="http://www.noah.org/wiki/CapsLock_Remap_Howto">CapsLock Remap Howto - Noah.org</a>.</p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-07-22T14:57:29+00:00"  data-updated="true" itemprop="datePublished dateCreated">Mon 22 Jul 2013,  2:57 PM</time>
        
           | <a href="/blog/python-doctests-and-decorators-bug/#disqus_thread" itemprop="discussionUrl"
             data-disqus-identifier="http://www.rosipov.com/blog/python-doctests-and-decorators-bug/">Comments</a>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/python-doctests-and-decorators-bug/" itemprop="url">Python doctests and decorators bug</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>Now, this as well might be a feature, but doctest strings are not being
executed for decorated functions (at least in version 2.7). However, there is a
workaround.</p>

<p>You need to decorate your functions with <code>functools.wraps</code> within a decorator
to import docstrings into a decorator scope.</p>

<pre><code>#!/usr/bin/env python

from functools import wraps

def decorator(func):
    @wraps(func)
    def wrapper():
        return func()
    return wrapper

@decorator
def foo():
    """
    &gt;&gt;&gt; foo()
    False
    """
    return True

import doctest
doctest.testmod()
</code></pre>

<p>Now you can see this test failing, where otherwise it would have been ignored:</p>

<pre><code>**********************************************************************
File "decorator.py", line 12, in __main__.foo
Failed example:
    foo()
Expected:
    False
Got:
    True
**********************************************************************
1 items had failures:
   1 of   1 in __main__.foo
***Test Failed*** 1 failures.
</code></pre>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-07-22T14:47:47+00:00"  data-updated="true" itemprop="datePublished dateCreated">Mon 22 Jul 2013,  2:47 PM</time>
        
           | <a href="/blog/python-tests-with-doctest-and-unittest/#disqus_thread" itemprop="discussionUrl"
             data-disqus-identifier="http://www.rosipov.com/blog/python-tests-with-doctest-and-unittest/">Comments</a>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/python-tests-with-doctest-and-unittest/" itemprop="url">Python tests with doctest and unittest</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>When it comes to tests, <code>doctest</code> is a great simple module to write tests for
your application. However it is pretty basic and does not have any extended
features like, for example, centralized unit tests. If you have multiple
modules with doctests (and you probably do) you most likely want to be able to
run all doctests recursively from one place. That&rsquo;s where <code>unittest</code> comes in.</p>

<p>Let&rsquo;s assume we store modules in the <code>lib/</code> directory:</p>

<pre><code>$ ls lib/
__init__.py bar.py foo.py
</code></pre>

<p>Here are the contents of <code>foo.py</code> and <code>bar.py</code> respectfully:</p>

<pre><code>def foo():
    """
    &gt;&gt;&gt; foo()
    False
    """
    return False

def bar():
    """
    &gt;&gt;&gt; bar()
    True
    """
    return True

def baz():
    """
    &gt;&gt;&gt; baz()
    False
    """
    return False
</code></pre>

<p>Now, to run all tests we need a wrapper script. Let&rsquo;s call it: <code>runtests.py</code>:</p>

<pre><code>#!/usr/bin/env python

import unittest
import doctest
import os

files = []
root_dir = 'lib/'

for root, _, filenames in os.walk(root_dir):
    for filename in filenames:
        if filename == '__init__.py' or filename[-3:] != '.py':
            continue
        f = os.path.join(root, filename)
        f = f.replace('/', '.')
        f = f[:-3]
        files.append(f)

suite = unittest.TestSuite()
for module in files:
    suite.addTest(doctest.DocTestSuite(module))
unittest.TextTestRunner(verbosity=1).run(suite)
</code></pre>

<p>This approach invokes the <code>doctest.DocTestSuite</code> method, which converts
doctests strings into unittest suites. Time to run our tests:</p>

<pre><code>$ chmod +x runtests.py
$ ./runtests.py
...
----------------------------------------------------------------------
Ran 3 tests in 0.008s

OK
</code></pre>

<p>And just to be sure that approach actually works, let&rsquo;s make one of the tests
fail:</p>

<pre><code>$ ./runtests.py
.F.
======================================================================
FAIL: baz (lib.bar)
Doctest: lib.bar.baz
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/usr/lib/python2.7/doctest.py", line 2201, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for lib.bar.baz
  File "/home/rosipov/unitdoc/lib/bar.py", line 8, in baz

----------------------------------------------------------------------
File "/home/rosipov/unitdoc/lib/bar.py", line 10, in lib.bar.baz
Failed example:
    baz()
Expected:
    True
Got:
    False

----------------------------------------------------------------------
Ran 3 tests in 0.009s

FAILED (failures=1)
</code></pre>
</div>
  
  


        </article>
      
    </div>

    <ul class="pager">
      
        <li class="previous"><a href="/posts/13">&larr;&nbsp;Older</a></li>
      
      <li><a href="/blog/archive">Blog Archive</a></li>
      
        <li class="next"><a href="/posts/11">Newer&nbsp;&rarr;</a></li>
      
    </ul>
  </div>

  
    <aside class="sidebar col-md-3">
      
        <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/blog/my-vimrc-annotated/">My .vimrc, Annotated</a>
    
    <a class="list-group-item " href="/blog/automating-octopress-publishing/">Automating Octorpress Publishing</a>
    
    <a class="list-group-item " href="/blog/a-trip-to-salt-lake-city/">A Trip to Salt Lake City</a>
    
    <a class="list-group-item " href="/blog/him-and-her-whats-inside-the-bag/">Him and Her: What&#8217;s Inside the Bag?</a>
    
    <a class="list-group-item " href="/blog/desktop-notifications-from-chrome-secure-shell/">Desktop Notifications from Chrome Secure Shell</a>
    
    <a class="list-group-item " href="/blog/journey-of-a-friend/">Journey of a friend</a>
    
    <a class="list-group-item " href="/blog/prius-adventures-a-year-later/">Prius adventures, a year later</a>
    
    <a class="list-group-item " href="/blog/hackmud-first-impressions/">Hackmud first impressions</a>
    
    <a class="list-group-item " href="/blog/a-year-with-pebble-time-round/">A year with Pebble Time Round</a>
    
    <a class="list-group-item " href="/blog/mob-level-distribution/">Mob level distribution</a>
    
  </div>
</section>

      
    </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2018 - Ruslan Osipov<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'rosipov';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




  </body>
</html>
